action:
  - choose:
      # Single button press toggles light brightness between 100% and 0%
      - conditions:
          - condition: template
            value_template: "{{ button_action == 'KeyPressed' }}"
        sequence:
          - choose:
              - conditions:
                  - condition: state
                    entity_id: !input target_light
                    state: "on"
                sequence:
                  - service: light.turn_off
                    data:
                      entity_id: !input target_light
                      transition: "{{ transition_time }}"
              - conditions:
                  - condition: state
                    entity_id: !input target_light
                    state: "off"
                sequence:
                  - service: light.turn_on
                    data:
                      entity_id: !input target_light
                      brightness_pct: 100
                      transition: "{{ transition_time }}"

      # Button hold sets light to a specific brightness
      - conditions:
          - condition: template
            value_template: "{{ button_action == 'KeyHeldDown' }}"
        sequence:
          - service: light.turn_on
            data:
              entity_id: !input target_light
              brightness_pct: !input hold_brightness
              transition: "{{ transition_time }}"
